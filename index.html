<!DOCTYPE html>
<html>
    <head>
        <title>QBJS</title>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="manifest" href="manifest.json"></link>
        <link rel="stylesheet" href="qbjs-ide.css"></link>
        <link rel="stylesheet" href="codemirror/codemirror.min.css"></link>
        <link rel="stylesheet" href="codemirror/dialog.css">
        <link rel="stylesheet" href="codemirror/matchesonscrollbar.css">
        <link id="ide-theme" rel="stylesheet" href="codemirror/themes/qbjs.css"></link>
        <link rel="shortcut icon" type="image/x-icon" href="favicon.ico"></link>

        <script type="text/javascript" src="codemirror/codemirror.min.js"></script>
        <script type="text/javascript" src="codemirror/qb-lang.js"></script>
        <script type="text/javascript" src="codemirror/active-line.js"></script>
        <script type="text/javascript" src="util/jszip.min.js"></script>
        <script type="text/javascript" src="util/lzutf8.js"></script>
        <script type="text/javascript" src="util/shorty.min.js"></script>
        <script type="text/javascript" src="util/pako.2.1.0.min.js"></script>
        <script type="text/javascript" src="util/hexy.js"></script>

        <script type="text/javascript" src="codemirror/lang/css.js"></script>
        <script type="text/javascript" src="codemirror/lang/clike.js"></script>
        <script type="text/javascript" src="codemirror/lang/javascript.js"></script>
        <script type="text/javascript" src="codemirror/lang/markdown.js"></script>
        <script type="text/javascript" src="codemirror/lang/python.js"></script>
        <script type="text/javascript" src="codemirror/lang/sql.js"></script>
        <script type="text/javascript" src="codemirror/lang/text.js"></script>
        <script type="text/javascript" src="codemirror/lang/xml.js"></script>
        <script type="text/javascript" src="codemirror/lang/htmlmixed.js"></script>
        <script type="text/javascript" src="codemirror/lang/php.js"></script>

        <script type="text/javascript" src="codemirror/dialog.js"></script>
        <script type="text/javascript" src="codemirror/searchcursor.js"></script>
        <script type="text/javascript" src="codemirror/search.js"></script>
        <script type="text/javascript" src="codemirror/annotatescrollbar.js"></script>
        <script type="text/javascript" src="codemirror/matchesonscrollbar.js"></script>
        <script type="text/javascript" src="codemirror/vim.js"></script>

        <script type="text/javascript" src="util/showdown.min.js"></script>
    </head>
    <body style="display:none">
        <div id="toolbar">
            <a href="javascript:IDE.newProject()" class="toolbar-button" id="toolbar-button-new" title="New"></a>
            <a href="javascript:IDE.openProject()" class="toolbar-button" id="toolbar-button-open" title="Open"></a>
            <a href="javascript:IDE.saveProject()" class="toolbar-button" id="toolbar-button-save" title="Save"></a>
            <div class="spacer"></div>
            <a href="javascript:IDE.runProgram()" class="toolbar-button" id="toolbar-button-run" title="Run"></a>
            <a href="javascript:IDE.stopProgram()" class="toolbar-button" id="toolbar-button-stop" title="Stop"></a>
            <a href="javascript:IDE.shareProgram()" class="toolbar-button" id="toolbar-button-share" title="Share / Export"></a>
            <div class="spacer"></div>
            <a href="javascript:IDE.showMethodDialog()" class="toolbar-button" id="toolbar-button-methods" title="Show Methods"></a>
            <a href="javascript:IDE.showOptionDialog()" class="toolbar-button" id="toolbar-button-settings" title="Settings"></a>

            <a href="javascript:IDE.showDialog('about-dialog')" class="toolbar-button" id="toolbar-button-about" title="About QBJS"></a>
            <div class="spacer" style="float:right"></div>
            <a href="javascript:IDE.showConsole()" class="toolbar-button" id="toolbar-button-console-show" title="Show Console"></a>
            <a href="javascript:IDE.showConsole()" class="toolbar-button" id="toolbar-button-console-hide" title="Hide Console" style="display:none"></a>
            <a href="javascript:IDE.slideRight()" class="toolbar-button" id="toolbar-button-slide-right" title="Slide View Right"></a>
            <a href="javascript:IDE.slideLeft()" class="toolbar-button" id="toolbar-button-slide-left" title="Slide View Left"></a>
        </div>
        <div id="code-container">
            <div id="code-tabs" class="tabs">
                <div id="code-tab-menu" class="tab"><div id="code-slide-left" onclick="IDE.codeTabSlideLeft()">◄</div><div id="code-slide-right" onclick="IDE.codeTabSlideRight()">►</div></div><div id="code-tab-container"><div id="mainbas" class="tab active" onclick="IDE.changeCodeTab(this)">Main</div></div></div>
            <div id="code"></div>
        </div>
        <div id="slider"></div>
        <div id="game-container">
            <div id="gx-container">
                <a href="javascript:runProgram()" id="gx-load-screen">&nbsp;</a>

                <!-- Hidden input for mobile soft keyboard -->
                <input 
                    id="gx-hidden-input" 
                    type="text" 
                    inputmode="text"
                    style="position:absolute;opacity:0;pointer-events:none;height:0;width:0;"
                />
            </div>
            <div id="vslider"></div>
            <div id="output-container">
                <div id="tabs">
                    <div id="tab-console" class="tab" onclick="IDE.changeTab('console')">Console</div>
                    <div id="tab-js" class="tab" onclick="IDE.changeTab('js')">Javascript</div>
                    <div id="tab-fs" class="tab" onclick="IDE.changeTab('fs')">Files</div>
                    <div id="tab-help" class="tab" onclick="IDE.changeTab('help')">Help</div>
                </div>
                <div id="output-content">
                    <div id="warning-container"></div>
                    <div id="js-code"></div>
                    <div id="fs-browser">
                        <div id="fs-path">
                            <span id="fs-url">/</span>
                            <div id="fs-refresh" title="Refresh" onclick="IDE.refreshFS()"></div>
                            <div id="fs-new-folder" title="New Directory" onclick="IDE.onNewDirectory()"></div>
                            <div id="fs-new-file" title="New File" onclick="IDE.onNewFile()"></div>
                            <div id="fs-upload" title="Upload" onclick="IDE.onUploadFile()"></div>
                        </div>
                        <div id="fs-contents"></div>
                    </div>
                    <div id="help">
                        <div id="help-nav" class="help-nav">
                            <a href="javascript:GitHelp.navhome()">Home</a>
                            <a href="javascript:GitHelp.navback()">Back</a>
                        </div>
                        <div id="help-container" class="help">
                            <div id="help-sidebar" class="help-sidebar"></div>
                            <div id="help-page"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="gx-footer"></div>

        <form style="display:none">
            <input id="file-input" type="file" accept=".bas, .zip">
        </form>

        <dialog id="share-dialog"> ... </dialog>
        <dialog id="prog-sel-dialog"> ... </dialog>
        <dialog id="options-dialog"> ... </dialog>
        <dialog id="methods-dialog"> ... </dialog>
        <dialog id="about-dialog"> ... </dialog>
    </body>
    
    <script language="javascript">
        const delay = ms => new Promise(res => setTimeout(res, ms));
    </script>
    
    <script language="javascript" src="vfs.js"></script>
    <script language="javascript" src="gx/gx.js"></script>
    <script language="javascript" src="qb.js"></script>
    
    <script language="javascript">
        if (typeof QB !== 'undefined' && typeof QB.init === 'function') {
            QB.init();
        }
    </script>
    
    <script language="javascript" src="qb2js.js"></script>
    <script language="javascript" src="githelp.js"></script>
    <script language="javascript" src="qbjs-ide.js"></script>
    
    <script language="javascript">
        if (window.initialQBasicCode) {
            const codeToLoad = window.initialQBasicCode;
            setTimeout(() => {
                let codeExecuted = false;
                if (typeof window.loadCode === 'function' && window.loadCode.toString().indexOf('initialQBasicCode') === -1) {
                    window.loadCode(codeToLoad);
                    codeExecuted = true;
                } 
                else if (typeof IDE !== 'undefined' && typeof IDE.loadCode === 'function') {
                    IDE.loadCode(codeToLoad);
                    codeExecuted = true;
                }
                if (!codeExecuted) {
                    console.error("ERROR: Cannot find a valid loadCode function to execute the stored code.");
                }
                delete window.initialQBasicCode; 
            }, 500);
        }
    </script>
    
</html>
